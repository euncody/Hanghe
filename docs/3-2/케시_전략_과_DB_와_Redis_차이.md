## 1. 캐시(Cache)의 기본 개념

* **캐시(Cache)** 는 “자주 쓰이는 데이터를 더 빠른 저장소에 임시로 저장해 두는 기술”입니다.
* DB는 디스크 기반이라 I/O가 느리고 부하가 크지만, **Redis 같은 인메모리 캐시**는 메모리에 바로 접근하므로 매우 빠릅니다.
* 목적: **“응답 속도 향상” + “DB 부하 감소”**

---

## 2. DB vs Redis의 역할

| 구분         | DB(MySQL 등)            | Redis(캐시)          |
| ---------- | ---------------------- | ------------------ |
| **역할**     | 진짜 정본(Source of Truth) | 임시 저장소(빠른 조회)      |
| **속도**     | 비교적 느림 (ms\~수십ms)      | 매우 빠름 (μs\~ms)     |
| **저장 위치**  | 디스크 기반                 | 메모리 기반             |
| **데이터 유지** | 영구 보존                  | TTL 만료 시 사라짐       |
| **부하 영향**  | 동시 조회가 많으면 부하 급증       | DB 대신 조회 가능, 부하 분산 |

---

## 3. 캐시 전략의 핵심 아이디어

1. **핫 데이터(자주 조회되는 데이터)** 를 Redis에 저장
2. **DB 대신 Redis에서 빠르게 조회**
3. 데이터가 변경되면 **캐시 무효화(갱신)** 로 최신 상태 유지

---

## 4. 캐싱 전략의 종류

| 전략                             | 설명                                        | 예시                 |
| ------------------------------ | ----------------------------------------- | ------------------ |
| **Cache Aside (Lazy Loading)** | 조회 시 캐시에 없으면(DB에서 읽고 캐시에 저장), 있으면 캐시에서 반환 | `@Cacheable` 방식    |
| **Write Through**              | DB에 저장할 때 동시에 캐시에도 저장                     | 주문 수량 업데이트 시 즉시 반영 |
| **Write Back**                 | 먼저 캐시에만 저장하고, 일정 주기 후 DB로 반영              | 성능은 좋지만 구현 난이도 높음  |
| **Read Through**               | 캐시에 없는 경우 캐시 레이어가 자동으로 DB에서 읽어옴           | 캐시 솔루션에 따라 지원      |

대부분의 Spring + Redis 환경은 **Cache Aside** 전략을 씁니다.

---

## 5. TTL(Time To Live)의 개념

* 캐시 데이터는 **영구 저장이 아님**
* **TTL**(유효기간)이 지나면 캐시가 삭제되고, 다음 조회에서 다시 DB를 조회 → 최신화
* 장점: 데이터 갱신 주기를 자동으로 유지
* 예:

    * 상품 랭킹: TTL 5분
    * 회원 세션: TTL 30분
    * 거의 변하지 않는 코드 테이블: TTL 1시간 이상

---

## 6. DB 폴백(Fallback) 개념

* 캐시가 비어있거나 장애가 있을 때, **DB를 백업 조회 경로**로 사용하는 것
* 즉, Redis는 “빠른 조수”, DB는 “최종 확정본”
* 흐름 예시:

    1. **Redis 조회** → 있으면 그대로 반환
    2. **없으면 DB 조회** → DB 결과를 Redis에 저장하고 반환

---

## 7. 장단점

| 장점               | 단점/주의점                               |
| ---------------- | ------------------------------------ |
| 응답 속도 향상 (ms→μs) | TTL 관리 필요                            |
| DB 부하 감소         | 캐시 데이터가 오래되면 “오래된 정보(Stale Data)” 가능 |
| 대규모 트래픽 처리 가능    | 데이터 변경 시 캐시 무효화 로직 필요                |

---

## 8. 요약

* **DB**: “정확하고 영구적인 데이터 저장소”
* **Redis 캐시**: “자주 조회되는 데이터의 빠른 접근을 위한 임시 저장소”
* **캐시 전략**: “Redis로 빠른 조회 → TTL로 최신화 → DB 폴백으로 안정성 보장”

